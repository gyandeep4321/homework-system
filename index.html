<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Homework Management System - Login</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

body{
  margin:0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#667eea,#764ba2);
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}

.login-box{
  background:#fff;
  width:360px;
  padding:30px;
  border-radius:12px;
  box-shadow:0 10px 30px rgba(0,0,0,0.2);
  text-align:center;
}

.login-box h2{
  margin-bottom:20px;
  color:#333;
}

.input-box{
  width:100%;
  margin-bottom:15px;
}

.input-box input{
  width:100%;
  padding:12px;
  border-radius:6px;
  border:1px solid #ccc;
  font-size:15px;
}

.input-box input:focus{
  outline:none;
  border-color:#667eea;
}

button{
  width:100%;
  padding:12px;
  background:#667eea;
  border:none;
  color:#fff;
  font-size:16px;
  border-radius:6px;
  cursor:pointer;
}

button:hover{
  background:#5563d6;
}

#msg{
  margin-top:15px;
  font-size:14px;
  font-weight:bold;
}

.loading{
  opacity:0.6;
  pointer-events:none;
}

</style>
</head>

<body>

<div class="login-box">

  <h2>Homework System Login</h2>

  <div class="input-box">
    <input type="text" id="username" placeholder="Username">
  </div>

  <div class="input-box">
    <input type="password" id="password" placeholder="Password">
  </div>

  <button onclick="login()">Login</button>

  <div id="msg"></div>

</div>


<script>

const API_URL = "https://script.google.com/macros/s/AKfycbxUgJ128UkvgkK8gAjr3Wijs5uLF2_SziiR3ShFoWW7EN79-fCoa0_Ap7C6r1detzrdFA/exec";


function login(){

  let user = document.getElementById("username").value.trim();
  let pass = document.getElementById("password").value.trim();
  let msg = document.getElementById("msg");

  if(user=="" || pass==""){
    msg.style.color="red";
    msg.innerText="Please enter username and password";
    return;
  }

  msg.style.color="blue";
  msg.innerText="Checking... Please wait";

  document.querySelector("button").classList.add("loading");

  let url = API_URL+
            "?action=login"+
            "&username="+encodeURIComponent(user)+
            "&password="+encodeURIComponent(pass);

  fetch(url)
  .then(res=>res.json())
  .then(data=>{

    document.querySelector("button").classList.remove("loading");

    if(data.status=="success"){

      localStorage.setItem("user",JSON.stringify(data));

      msg.style.color="green";
      msg.innerText="Login Successful! Redirecting...";

      setTimeout(()=>{

        if(data.role=="teacher"){
          window.location.href="teacher.html";
        }else{
          window.location.href="student.html";
        }

      },1200);

    }else{

      msg.style.color="red";
      msg.innerText="Invalid Username or Password";

    }

  })
  .catch(err=>{

    document.querySelector("button").classList.remove("loading");

    msg.style.color="red";
    msg.innerText="Server Error. Try Again";

  });

}


// Auto Login
window.onload = function(){

  let user = localStorage.getItem("user");

  if(user){

    let data = JSON.parse(user);

    if(data.role=="teacher"){
      window.location.href="teacher.html";
    }else{
      window.location.href="student.html";
    }

  }

};

</script>

</body>
</html>
